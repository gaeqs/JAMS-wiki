"use strict";(self.webpackChunkjamswiki=self.webpackChunkjamswiki||[]).push([[753],{3905:function(e,n,a){a.d(n,{Zo:function(){return d},kt:function(){return m}});var t=a(7294);function r(e,n,a){return n in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}function s(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),a.push.apply(a,t)}return a}function o(e){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?s(Object(a),!0).forEach((function(n){r(e,n,a[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(a,n))}))}return e}function i(e,n){if(null==e)return{};var a,t,r=function(e,n){if(null==e)return{};var a,t,r={},s=Object.keys(e);for(t=0;t<s.length;t++)a=s[t],n.indexOf(a)>=0||(r[a]=e[a]);return r}(e,n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(t=0;t<s.length;t++)a=s[t],n.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var l=t.createContext({}),c=function(e){var n=t.useContext(l),a=n;return e&&(a="function"==typeof e?e(n):o(o({},n),e)),a},d=function(e){var n=c(e.components);return t.createElement(l.Provider,{value:n},e.children)},u={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},p=t.forwardRef((function(e,n){var a=e.components,r=e.mdxType,s=e.originalType,l=e.parentName,d=i(e,["components","mdxType","originalType","parentName"]),p=c(a),m=r,v=p["".concat(l,".").concat(m)]||p[m]||u[m]||s;return a?t.createElement(v,o(o({ref:n},d),{},{components:a})):t.createElement(v,o({ref:n},d))}));function m(e,n){var a=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var s=a.length,o=new Array(s);o[0]=p;var i={};for(var l in n)hasOwnProperty.call(n,l)&&(i[l]=n[l]);i.originalType=e,i.mdxType="string"==typeof e?e:r,o[1]=i;for(var c=2;c<s;c++)o[c]=a[c];return t.createElement.apply(null,o)}return t.createElement.apply(null,a)}p.displayName="MDXCreateElement"},1723:function(e,n,a){a.r(n),a.d(n,{assets:function(){return d},contentTitle:function(){return l},default:function(){return m},frontMatter:function(){return i},metadata:function(){return c},toc:function(){return u}});var t=a(7462),r=a(3366),s=(a(7294),a(3905)),o=["components"],i={sidebar_position:3},l="Eventos",c={unversionedId:"architecture/events",id:"architecture/events",title:"Eventos",description:"JAMS incluye un sistema de eventos que permite informar de sucesos entre componentes de la aplicaci\xf3n. Este sistema est\xe1",source:"@site/i18n/es/docusaurus-plugin-content-docs/current/architecture/events.md",sourceDirName:"architecture",slug:"/architecture/events",permalink:"/es/docs/architecture/events",editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/architecture/events.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"docsSidebar",previous:{title:"Gestores",permalink:"/es/docs/architecture/managers"}},d={},u=[{value:"Emisores de eventos",id:"emisores-de-eventos",level:2},{value:"Definir escuchas",id:"definir-escuchas",level:2},{value:"Registrar escuchas",id:"registrar-escuchas",level:2},{value:"Eventos cancelables",id:"eventos-cancelables",level:2},{value:"Par\xe1metros avanzados",id:"par\xe1metros-avanzados",level:2}],p={toc:u};function m(e){var n=e.components,a=(0,r.Z)(e,o);return(0,s.kt)("wrapper",(0,t.Z)({},p,a,{components:n,mdxType:"MDXLayout"}),(0,s.kt)("h1",{id:"eventos"},"Eventos"),(0,s.kt)("p",null,"JAMS incluye un sistema de eventos que permite informar de sucesos entre componentes de la aplicaci\xf3n. Este sistema est\xe1\nprofundamente inspirado en el sistema de eventos usado por la comunidad de ",(0,s.kt)("em",{parentName:"p"},"Minecraft")," en proyectos\ncomo ",(0,s.kt)("a",{parentName:"p",href:"https://www.spigotmc.org/"},"Spigot")," o ",(0,s.kt)("a",{parentName:"p",href:"https://www.spongepowered.org/"},"Sponge"),", y puede considerarse una evoluci\xf3n\ndescentralizada de esta tecnolog\xeda."),(0,s.kt)("h2",{id:"emisores-de-eventos"},"Emisores de eventos"),(0,s.kt)("p",null,"Los emisores de eventos son los encargados de relacionar los creadores de eventos con sus escuchadores. Un emisor de\nevento est\xe1 representado por la interfaz ",(0,s.kt)("inlineCode",{parentName:"p"},"EventBroadcast"),". Esta interfaz es implementada por cualquier elemento que\nquiera ser usado para registrar escuchas (Gestores, plugins, o el propio JAMS implementan un emisor)."),(0,s.kt)("p",null,"La clase ",(0,s.kt)("inlineCode",{parentName:"p"},"SimpleEventBroadcast")," contiene una implementaci\xf3n de ",(0,s.kt)("inlineCode",{parentName:"p"},"EventBroadcast")," que se puede usar como superclase."),(0,s.kt)("h2",{id:"definir-escuchas"},"Definir escuchas"),(0,s.kt)("p",null,"Las escuchas son m\xe9todos no est\xe1ticos anotados con la anotaci\xf3n ",(0,s.kt)("inlineCode",{parentName:"p"},"@Listener"),". Estos m\xe9todos solo tienen un par\xe1metro que\npide un elemento que extienda la clase ",(0,s.kt)("inlineCode",{parentName:"p"},"Event")," y deben devolver ",(0,s.kt)("inlineCode",{parentName:"p"},"void"),"."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-java"},'@Listener\nprivate void onLanguageRegister(ManagerElementRegisterEvent.After<Language> event) {\n    System.out.println("New language available! " + event.getElement().getName());\n}\n')),(0,s.kt)("p",null,"Este m\xe9todo, despu\xe9s de ser registrado en un ",(0,s.kt)("a",{parentName:"p",href:"managers"},"gestor")," de idiomas, se ejecutar\xe1 cuando un nuevo idioma sea\na\xf1adido al gestor."),(0,s.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,s.kt)("div",{parentName:"div",className:"admonition-heading"},(0,s.kt)("h5",{parentName:"div"},(0,s.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,s.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,s.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"Gen\xe9ricos")),(0,s.kt)("div",{parentName:"div",className:"admonition-content"},(0,s.kt)("p",{parentName:"div"},"A diferencia de otros sistemas de eventos similares, el sistema de eventos de JAMS permite usar eventos gen\xe9ricos. Un\nejemplo es el caso anterior, donde el m\xe9todo pide un elemento de tipo ",(0,s.kt)("inlineCode",{parentName:"p"},"ManagerElementRegisterEvent.After<Language>"),"."),(0,s.kt)("p",{parentName:"div"},"Si el emisor al que est\xe1 registrado emite un evento de tipo ",(0,s.kt)("inlineCode",{parentName:"p"},"ManagerElementRegisterEvent.After<Theme>"),", la escucha ",(0,s.kt)("strong",{parentName:"p"},"no"),"\nser\xe1 invocada."))),(0,s.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,s.kt)("div",{parentName:"div",className:"admonition-heading"},(0,s.kt)("h5",{parentName:"div"},(0,s.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,s.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,s.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"Herencias")),(0,s.kt)("div",{parentName:"div",className:"admonition-content"},(0,s.kt)("p",{parentName:"div"},"Un evento puede extender la clase de otro evento. Esto permite generar una jerarqu\xeda de eventos. Una escucha que pide un\ncierto tipo de evento se ejecutar\xe1 siempre que dicho evento o uno de sus hijos ocurra."),(0,s.kt)("p",{parentName:"div"},"Si una escucha pide el evento ",(0,s.kt)("inlineCode",{parentName:"p"},"Event"),", su m\xe9todo se ejecutar\xe1 siempre que un evento ocurra."))),(0,s.kt)("h2",{id:"registrar-escuchas"},"Registrar escuchas"),(0,s.kt)("p",null,"Una vez se tenga una escucha definida, esta se puede registrar en uno o varios emisores de eventos."),(0,s.kt)("p",null,"Al ser las escuchas no est\xe1ticas, toda escucha registrada en un emisor est\xe1 ligada al evento con el que debe ser\ninvocado. Esto a\xf1ade una gran flexibilidad al sistema, permitiendo que un elemento registre escuchas dependiendo de su\nestado."),(0,s.kt)("p",null,"El m\xe9todo m\xe1s usado para registrar escuchas es el m\xe9todo ",(0,s.kt)("inlineCode",{parentName:"p"},"registerListeners(Object, boolean)"),". Este m\xe9todo buscar\xe1 en el\nobjeto todos los m\xe9todos con la etiqueta ",(0,s.kt)("inlineCode",{parentName:"p"},"@Listener")," que pidan un evento y devuelvan ",(0,s.kt)("inlineCode",{parentName:"p"},"void"),". Esta b\xfasqueda incluye a\n",(0,s.kt)("strong",{parentName:"p"},"todos")," los m\xe9todos definidos en el objeto, incluyendo m\xe9todos privados y m\xe9todos de las superclases."),(0,s.kt)("p",null,"El booleano ",(0,s.kt)("inlineCode",{parentName:"p"},"useWeakReferences")," permite registrar la escucha usando una ",(0,s.kt)("strong",{parentName:"p"},"referencia d\xe9bil"),". Si este booleano es falso,\nel objeto usado para el registro quedar\xe1 en memoria aunque todas sus referencias cesen de existir, por lo que se debe\neliminar el registro de manera manual. La referencia d\xe9bil elimina este paso, borr\xe1ndose el registro autom\xe1ticamente\ncuando el elemento deje de ser referenciado."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-java"},'private void register() {\n    Manager<Language> manager = Manager.of(Language.class);\n    manager.registerListeners(this, true);\n}\n\n@Listener\nprivate void onLanguageRegister(ManagerElementRegisterEvent.After<Language> event) {\n    System.out.println("New language available! " + event.getElement().getName());\n}\n')),(0,s.kt)("p",null,"Si se desea, se puede registrar una \xfanica escucha del objeto. Este m\xe9todo requiere conocimientos de la\nlibrer\xeda ",(0,s.kt)("inlineCode",{parentName:"p"},"reflection")," de Java:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-java"},'private void register() throws NoSuchMethodException {\n    Manager<Language> manager = Manager.of(Language.class);\n    manager.registerListener(\n            this,\n            this.getClass().getDeclaredMethod("onLanguageRegister", ManagerElementRegisterEvent.class),\n            true\n    );\n}\n\n@Listener()\nprivate void onLanguageRegister(ManagerElementRegisterEvent.After<Language> event) {\n    System.out.println("New language available! " + event.getElement().getName());\n}\n')),(0,s.kt)("p",null,"Para eliminar los registros, se han de usar los m\xe9todos an\xe1logos ",(0,s.kt)("inlineCode",{parentName:"p"},"unregisterListeners")," y ",(0,s.kt)("inlineCode",{parentName:"p"},"unregisterListener"),"."),(0,s.kt)("h2",{id:"eventos-cancelables"},"Eventos cancelables"),(0,s.kt)("p",null,"Algunos eventos implementan la interfaz ",(0,s.kt)("inlineCode",{parentName:"p"},"Cancellable"),", lo cual permite cancelar el evento. Las escuchas restantes no\nser\xe1n llamadas cuando un evento es cancelado salvo que ",(0,s.kt)("inlineCode",{parentName:"p"},"ignoreCancelled")," sea ",(0,s.kt)("inlineCode",{parentName:"p"},"true"),"."),(0,s.kt)("h2",{id:"par\xe1metros-avanzados"},"Par\xe1metros avanzados"),(0,s.kt)("p",null,"La etiqueta ",(0,s.kt)("inlineCode",{parentName:"p"},"@Listener")," permite definir comportamientos m\xe1s avanzados en la escucha."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-java"},'@Listener(priority = 20, ignoreCancelled = true)\nprivate void onLanguageRegister(ManagerElementRegisterEvent.After<Language> event) {\n    System.out.println("New language available! " + event.getElement().getName());\n}\n')),(0,s.kt)("p",null,"El par\xe1metro ",(0,s.kt)("inlineCode",{parentName:"p"},"priority")," permite definir la prioridad de la escucha. La escucha con un n\xfamero m\xe1s alto ser\xe1 la primera en\nser llamada."),(0,s.kt)("p",null,"El par\xe1metro ",(0,s.kt)("inlineCode",{parentName:"p"},"ignoreCancelled")," es un booleano que le da a la escucha la capacidad de ser llamada incluso cuando un\nevento ha sido cancelado."))}m.isMDXComponent=!0}}]);